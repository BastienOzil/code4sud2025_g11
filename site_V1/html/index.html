<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarketAI - Analyse de March√© Intelligente</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Leaflet CSS pour la carte interactive -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Chart.js pour les graphiques -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <h1>MarketAI</h1>
                <p class="subtitle">Analyse de march√© intelligente et instantan√©e bas√©e sur les donn√©es publiques</p>
                <div class="badges">
                    <span class="badge">Conforme RGPD</span>
                    <span class="badge">Analyse en temps r√©el</span>
                    <span class="badge">Data.gouv.fr</span>
                    <span class="badge">Assist√© par IA</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Search Form -->
            <section class="search-section">
                <div class="card">
                    <h2>D√©marrer une analyse de march√©</h2>
                    <p style="color: #605E5C; margin-bottom: 24px;">
                        Obtenez une √©tude de march√© compl√®te en quelques minutes gr√¢ce √† l'analyse automatis√©e des
                        donn√©es publiques.
                    </p>
                    <form id="analyzeForm">
                        <div class="form-group">
                            <label for="sector">Secteur d'activit√© *</label>
                            <input type="text" id="sector" name="sector"
                                placeholder="Ex: commerce, restauration, technologie, sant√©..." required>
                            <small>Quel est votre secteur d'activit√© ?</small>
                        </div>

                <div class="form-group">
                    <label for="location">R√©gion ou Zone g√©ographique</label>
                    <div class="location-input-wrapper">
                        <input type="text" id="location" name="location" 
                               placeholder="Ex: Occitanie, Toulouse, PACA, Nice, Auvergne-Rh√¥ne-Alpes...">
                        <button type="button" id="geolocateBtn" class="btn-geolocate" title="Utiliser ma position">
                            <span class="geo-icon">üìç</span>
                        </button>
                    </div>
                    <small>Optionnel - Pr√©cisez la r√©gion ou ville √† analyser (d√©tection automatique de r√©gion)</small>
                </div>
                        <button type="submit" class="btn-primary">
                            <span class="btn-text">Lancer l'analyse intelligente</span>
                        </button>
                    </form>
                </div>
            </section>

            <!-- Loading State -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Analyse en cours... R√©cup√©ration et traitement des donn√©es publiques</p>
            </div>

            <!-- Results Section -->
            <section id="results" class="results-section" style="display: none;">
                <div class="card">
                    <h2>R√©sultats de l'analyse</h2>
                    <div id="resultsContent"></div>
                </div>
            </section>

            <!-- About Section -->
            <section class="about-section">
                <div class="card">
                    <h2>√Ä propos de MarketAI</h2>
                    <p>
                        <strong>MarketAI</strong> est un assistant IA d√©velopp√© pour <strong>Code4Sud 2025</strong>
                        qui r√©volutionne les √©tudes de march√©. Fini les analyses co√ªteuses et
                        obsol√®tes ! Notre solution automatis√©e offre :
                    </p>
                    <ul class="benefits-list">
                        <li>Analyse automatique en quelques minutes</li>
                        <li>Identification des acteurs cl√©s du march√©</li>
                        <li>Cartographie des relations √©conomiques</li>
                        <li>Veille concurrentielle en temps r√©el</li>
                        <li>Export synth√©tique pour business plan</li>
                        <li>100% conforme au RGPD</li>
                    </ul>
                    <p class="impact">
                        <strong>Impact √âco Dev :</strong> Donne aux acteurs √©conomiques locaux
                        un outil strat√©gique d'aide √† la d√©cision accessible et moderne.
                    </p>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer
            style="margin-top: 50px; padding: 20px 0; border-top: 1px solid #ddd; text-align: center; color: #666; font-size: 14px;">
            <strong>D√©velopp√© pour Code4Sud 2025</strong> - √âquipe 11<br>
            Analyse de march√© bas√©e sur les donn√©es ouvertes fran√ßaises
    </div>

    <script>
        // Loader dynamique pour g√©rer ouverture locale (file://) depuis le dossier html/
        (function () {
            try {
                const isFile = window.location.protocol === 'file:';
                const path = window.location.pathname || '';

                const prodCss = 'css/style.css';
                const prodJs = 'js/script.js';
                const localCss = '../css/style.css';
                const localJs = '../js/script.js';

                let cssHref = prodCss;
                let jsSrc = prodJs;

                if (isFile && path.includes('/html/')) {
                    cssHref = localCss;
                    jsSrc = localJs;
                }

                // Mettre √† jour ou ajouter le lien CSS
                let cssLink = document.querySelector('link[rel=stylesheet][href]');
                if (cssLink) {
                    cssLink.href = cssHref;
                } else {
                    cssLink = document.createElement('link');
                    cssLink.rel = 'stylesheet';
                    cssLink.href = cssHref;
                    document.head.appendChild(cssLink);
                }

                // Charger le script principal dynamiquement
                const s = document.createElement('script');
                s.src = jsSrc;
                s.defer = true;
                document.body.appendChild(s);
            } catch (e) {
                console.error('Erreur loader local CSS/JS:', e);
            }
        })();
    </script>
</body>

</html>